apiVersion: v1
kind: Service
metadata:
  name: "{{ .Release.Name }}-back-service-lb"
  namespace: {{ .Values.namespace }}
  labels:
    app: "{{ .Release.Name }}-back-deployment"
spec:
  selector:
    app: "{{ .Release.Name }}-back-deployment"
  ports:
    - protocol: TCP
      port: 80  # Port d'écoute principal
      targetPort: 5000  # Port sur lequel vos pods écoutent
      nodePort: 30080  # Port NodePort
  type: LoadBalancer
  externalTrafficPolicy: Local
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
    service.beta.kubernetes.io/aws-load-balancer-name: "{{ .Release.Name }}-back-service-lb"
    service.beta.kubernetes.io/aws-load-balancer-internal: "false"
    service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"
    
